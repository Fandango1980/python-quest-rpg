<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Quest - Word de Held van Pythonia</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Intro Screen */
        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 1s ease-in;
        }
        
        .intro-content {
            max-width: 800px;
            padding: 40px;
            text-align: center;
            animation: slideUp 1s ease-out;
        }
        
        .intro-content h1 {
            font-size: 4em;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255,215,0,0.5);
            animation: glow 2s ease-in-out infinite;
        }
        
        .intro-story {
            font-size: 1.3em;
            line-height: 1.8;
            margin: 30px 0;
            text-align: left;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid rgba(255,215,0,0.3);
        }
        
        .intro-story p {
            margin-bottom: 20px;
        }
        
        .start-btn {
            padding: 20px 50px;
            font-size: 1.5em;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(245,87,108,0.4);
            transition: all 0.3s ease;
            margin-top: 30px;
        }
        
        .start-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(245,87,108,0.6);
        }
        
        /* Tutorial Overlay */
        #tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
        }
        
        .tutorial-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .tutorial-box h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        
        .tutorial-box p {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .tutorial-code {
            background: #1e1e1e;
            color: #0f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            margin: 20px 0;
            text-align: left;
        }
        
        .next-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            background: #fff;
            color: #667eea;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .next-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255,255,255,0.3);
        }
        
        /* Game Container */
        .game-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            display: none;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
        }
        
        header h1 {
            font-size: 3em;
            text-shadow: 0 0 20px rgba(255,215,0,0.5);
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            color: #ffd700;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
        }
        
        .panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 20px;
        }
        
        h2 {
            color: #ffd700;
            margin-bottom: 15px;
            border-bottom: 2px solid rgba(255,215,0,0.3);
            padding-bottom: 10px;
            font-size: 1.3em;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 1.1em;
        }
        
        .stat-item:last-child { border-bottom: none; }
        
        .progress-bar {
            width: 100%;
            height: 25px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 10px;
            border: 2px solid rgba(255,215,0,0.3);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f093fb, #f5576c);
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(245,87,108,0.5);
        }
        
        .skill-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            margin: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .story-text {
            line-height: 1.8;
            font-size: 1.1em;
            color: #e0e0e0;
        }
        
        .challenge-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
            border-radius: 10px;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 1.1em;
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 5px 15px rgba(245,87,108,0.3);
        }
        
        #code-input {
            width: 100%;
            min-height: 180px;
            padding: 20px;
            border: 2px solid rgba(255,215,0,0.3);
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            background: rgba(0,0,0,0.5);
            color: #0f0;
            resize: vertical;
        }
        
        #code-input:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255,215,0,0.3);
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            flex: 1;
            box-shadow: 0 5px 15px rgba(245,87,108,0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(245,87,108,0.5);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .btn-next-lesson {
            background: linear-gradient(135deg, #00d2ff, #3a7bd5);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            width: 100%;
            box-shadow: 0 5px 15px rgba(58,123,213,0.3);
            transition: all 0.3s ease;
        }

        .btn-next-lesson:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(58,123,213,0.5);
        }
        
        #output {
            background: rgba(0,0,0,0.7);
            color: #0f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            min-height: 120px;
            white-space: pre-wrap;
            margin-top: 15px;
            border: 2px solid rgba(0,255,0,0.3);
            font-size: 1.05em;
        }
        
        .chapter-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 10px 15px;
            border-radius: 10px;
            margin: 15px 0 10px 0;
            font-weight: bold;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chapter-header:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
        }

        .chapter-header.locked {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .chapter-lessons {
            margin-left: 15px;
        }
        
        .lesson-item {
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
            cursor: pointer;
            background: rgba(255,255,255,0.1);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 2px solid transparent;
            font-size: 0.95em;
        }
        
        .lesson-item:hover:not(.locked) {
            background: rgba(255,255,255,0.2);
            transform: translateX(5px);
            border-color: rgba(255,215,0,0.5);
        }
        
        .lesson-item.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            font-weight: bold;
            border-color: #ffd700;
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
        }
        
        .lesson-item.locked {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        .lesson-item.completed {
            background: rgba(0,255,0,0.2);
            border-color: rgba(0,255,0,0.3);
        }

        .lesson-item.unlocked {
            animation: pulse 1s ease-in-out 3;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(255,215,0,0.6); }
        }
        
        .success { color: #00ff00; font-weight: bold; text-shadow: 0 0 10px #00ff00; }
        .error { color: #ff4444; font-weight: bold; text-shadow: 0 0 10px #ff4444; }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px rgba(255,215,0,0.5); }
            50% { text-shadow: 0 0 40px rgba(255,215,0,0.8), 0 0 60px rgba(255,215,0,0.6); }
        }
        
        @media (max-width: 1200px) {
            .main-content { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Intro Screen -->
    <div id="intro-screen">
        <div class="intro-content">
            <h1>üêç Python Quest</h1>
            <div class="intro-story">
                <p><strong>üìñ Het Verhaal van Pythonia</strong></p>
                <p>In het mystieke land van <strong>Pythonia</strong> leefden de mensen eeuwenlang in vrede. Maar op een dag verschenen er vreemde monsters uit het Digitale Bos - bugs, errors en crashes die het land bedreigden.</p>
                <p>Jij bent <strong>de Uitverkorene</strong>, een jonge held die de oude kunst van <strong>Code Magie</strong> moet leren om je dorp te beschermen.</p>
                <p>De wijze tovenaar <strong>Pythonicus</strong> zal je door <strong>6 epische hoofdstukken</strong> leiden - van absolute beginner tot meester-programmeur!</p>
                <p><strong>‚öîÔ∏è Jouw reis:</strong></p>
                <p>üìò <strong>Hoofdstuk 1:</strong> De Basis Spreuken<br>
                üìó <strong>Hoofdstuk 2:</strong> Geavanceerde Technieken<br>
                üìô <strong>Hoofdstuk 3:</strong> Data Manipulatie<br>
                üìï <strong>Hoofdstuk 4:</strong> Objectgeori√´nteerd Programmeren<br>
                üìî <strong>Hoofdstuk 5:</strong> Foutafhandeling & Bestanden<br>
                üìì <strong>Hoofdstuk 6:</strong> Meester Programmeur</p>
            </div>
            <button class="start-btn" onclick="startGame()">üéÆ Begin je Avontuur!</button>
        </div>
    </div>

    <!-- Tutorial Overlay -->
    <div id="tutorial-overlay">
        <div class="tutorial-box">
            <h2 id="tutorial-title">üéì Les 1: De Print Spreuk</h2>
            <p id="tutorial-text">Welkom, jonge held! Ik ben Pythonicus, je mentor. De eerste spreuk die je moet leren is de <strong>print()</strong> spreuk. Hiermee kun je berichten tonen en de monsters verzwakken!</p>
            <div class="tutorial-code" id="tutorial-code">print("Hallo Wereld!")</div>
            <p id="tutorial-instruction">üëÜ Dit is hoe je de print spreuk gebruikt. Typ tekst tussen aanhalingstekens binnen de haakjes.</p>
            <button class="next-btn" onclick="nextTutorial()">Volgende ‚Üí</button>
        </div>
    </div>

    <!-- Game Container -->
    <div class="game-container">
        <header>
            <h1>üêç Python Quest</h1>
            <p class="subtitle">‚öîÔ∏è Bescherm Pythonia met de Kracht van Code!</p>
        </header>

        <div class="main-content">
            <!-- Left Panel -->
            <div>
                <div class="panel">
                    <h2>üßô‚Äç‚ôÇÔ∏è Jouw Held</h2>
                    <div class="stat-item"><span>üë§ Naam:</span><span>Code Krijger</span></div>
                    <div class="stat-item"><span>‚≠ê Level:</span><span id="level">1</span></div>
                    <div class="stat-item"><span>‚ù§Ô∏è HP:</span><span id="hp">100/100</span></div>
                    <div class="stat-item"><span>‚ú® XP:</span><span id="xp">0/100</span></div>
                    <div class="progress-bar"><div id="xp-bar" class="progress-fill"></div></div>
                </div>
                
                <div class="panel">
                    <h2>üëæ Vijand</h2>
                    <div class="stat-item"><span>Naam:</span><span id="enemy-name">-</span></div>
                    <div class="stat-item"><span>üíÄ HP:</span><span id="enemy-hp">-</span></div>
                    <div class="stat-item"><span>üéØ Aanval:</span><span id="attack-count">0/3</span></div>
                </div>
                
                <div class="panel">
                    <h2>üéØ Geleerde Spreuken</h2>
                    <div id="skills"></div>
                </div>
            </div>

            <!-- Center Panel -->
            <div>
                <div class="panel">
                    <h2>üìñ Het Verhaal</h2>
                    <div class="story-text" id="story"></div>
                </div>
                
                <div class="panel">
                    <h2>‚öîÔ∏è Jouw Uitdaging</h2>
                    <div class="challenge-box" id="challenge"></div>
                    
                    <h2>üíª Schrijf je Code Spreuk:</h2>
                    <textarea id="code-input" placeholder="# Typ hier je Python code...
# Bijvoorbeeld: print('Hallo Pythonia!')"></textarea>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="runCode()">‚ñ∂Ô∏è Voer Spreuk Uit!</button>
                        <button class="btn btn-secondary" onclick="showHint()">üí° Vraag Hulp</button>
                    </div>
                    <div id="output"></div>
                    <div id="next-lesson-container"></div>
                </div>
            </div>

            <!-- Right Panel -->
            <div>
                <div class="panel">
                    <h2>üìö Jouw Reis</h2>
                    <div id="lessons"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/Fandango1980/python-quest-rpg@main/lessons.js"></script>
    <script>
        let game = {
            player: { level: 1, hp: 100, maxHp: 100, xp: 0, xpNext: 100, skills: [] },
            currentLesson: '1-1',
            enemy: null,
            tutorialStep: 0,
            completedLessons: [],
            maxUnlockedLesson: '1-1',
            currentAttack: 0,
            usedChallenges: []
        };

        const tutorialSteps = [
            {
                title: 'üéì Les 1: De Print Spreuk',
                text: 'Welkom, jonge held! Ik ben Pythonicus, je mentor. De eerste spreuk die je moet leren is de <strong>print()</strong> spreuk. Hiermee kun je berichten tonen!',
                code: 'print("Hallo Wereld!")',
                instruction: 'üëÜ Dit is hoe je de print spreuk gebruikt. Typ tekst tussen aanhalingstekens binnen de haakjes.'
            },
            {
                title: 'üìù Hoe schrijf je code?',
                text: 'Kijk goed naar de structuur:<br><br>1Ô∏è‚É£ <strong>print</strong> - de naam van de spreuk<br>2Ô∏è‚É£ <strong>()</strong> - haakjes eromheen<br>3Ô∏è‚É£ <strong>"tekst"</strong> - je bericht tussen aanhalingstekens',
                code: 'print("Dit is mijn bericht!")',
                instruction: 'üí° Je kunt ook enkele aanhalingstekens gebruiken: print(\'Hallo!\')'
            },
            {
                title: '‚öîÔ∏è Tijd om te vechten!',
                text: 'Nu ga je je eerste monster verslaan! Typ de code <strong>exact</strong> zoals je het geleerd hebt in het code veld hieronder.',
                code: 'print("Hallo Pythonia!")',
                instruction: 'üéØ Typ dit in het code veld en klik op "Voer Spreuk Uit!" om de Syntax Bug aan te vallen!'
            }
        ];

        function startGame() {
            document.getElementById('intro-screen').style.display = 'none';
            document.getElementById('tutorial-overlay').style.display = 'flex';
        }

        function nextTutorial() {
            game.tutorialStep++;
            if (game.tutorialStep < tutorialSteps.length) {
                const step = tutorialSteps[game.tutorialStep];
                document.getElementById('tutorial-title').innerHTML = step.title;
                document.getElementById('tutorial-text').innerHTML = step.text;
                document.getElementById('tutorial-code').textContent = step.code;
                document.getElementById('tutorial-instruction').innerHTML = step.instruction;
            } else {
                document.getElementById('tutorial-overlay').style.display = 'none';
                document.querySelector('.game-container').style.display = 'block';
                loadLesson('1-1');
            }
        }

        function loadLesson(lessonId) {
            const lesson = lessons[lessonId];
            if (!lesson) return;
            
            game.currentLesson = lessonId;
            game.enemy = { ...lesson.enemy };
            game.currentAttack = 0;
            game.usedChallenges = [];
            
            document.getElementById('story').innerHTML = lesson.story;
            document.getElementById('challenge').innerHTML = lesson.challenges[0].text;
            document.getElementById('enemy-name').textContent = lesson.enemy.name;
            document.getElementById('output').innerHTML = '';
            document.getElementById('code-input').value = '';
            document.getElementById('next-lesson-container').innerHTML = '';
            
            renderLessons();
            updateUI();
        }

        function getNextLessonId(currentId) {
            const [chapter, lessonNum] = currentId.split('-').map(Number);
            if (lessonNum < 6) {
                return `${chapter}-${lessonNum + 1}`;
            } else if (chapter < 6) {
                return `${chapter + 1}-1`;
            }
            return null;
        }

        function renderLessons() {
            const lessonsDiv = document.getElementById('lessons');
            lessonsDiv.innerHTML = '';
            
            const chapters = {
                1: { name: 'üìò Hoofdstuk 1: Basis Spreuken', icon: 'üå±' },
                2: { name: 'üìó Hoofdstuk 2: Geavanceerde Technieken', icon: 'üåø' },
                3: { name: 'üìô Hoofdstuk 3: Data Manipulatie', icon: 'üå≥' },
                4: { name: 'üìï Hoofdstuk 4: OOP', icon: 'üè∞' },
                5: { name: 'üìî Hoofdstuk 5: Bestanden & Errors', icon: '‚öîÔ∏è' },
                6: { name: 'üìì Hoofdstuk 6: Meester Niveau', icon: 'üëë' }
            };

            for (let chapter = 1; chapter <= 6; chapter++) {
                const chapterDiv = document.createElement('div');
                const chapterHeader = document.createElement('div');
                chapterHeader.className = 'chapter-header';
                
                const [currentChapter] = game.currentLesson.split('-').map(Number);
                const maxChapter = parseInt(game.maxUnlockedLesson.split('-')[0]);
                
                if (chapter > maxChapter) {
                    chapterHeader.classList.add('locked');
                }
                
                chapterHeader.innerHTML = `${chapters[chapter].icon} ${chapters[chapter].name}`;
                chapterDiv.appendChild(chapterHeader);
                
                const lessonsContainer = document.createElement('div');
                lessonsContainer.className = 'chapter-lessons';
                
                for (let lessonNum = 1; lessonNum <= 6; lessonNum++) {
                    const lessonId = `${chapter}-${lessonNum}`;
                    const lesson = lessons[lessonId];
                    if (!lesson) continue;
                    
                    const div = document.createElement('div');
                    div.className = 'lesson-item';
                    
                    if (lessonId === game.currentLesson) {
                        div.classList.add('active');
                    } else if (game.completedLessons.includes(lessonId)) {
                        div.classList.add('completed');
                    } else if (!isLessonUnlocked(lessonId)) {
                        div.classList.add('locked');
                    }
                    
                    const icon = game.completedLessons.includes(lessonId) ? '‚úÖ' : `${chapter}.${lessonNum}`;
                    div.innerHTML = `<span>${icon}</span><span>${lesson.title.split(':')[1] || lesson.title}</span>`;
                    
                    if (isLessonUnlocked(lessonId)) {
                        div.onclick = () => loadLesson(lessonId);
                    }
                    
                    lessonsContainer.appendChild(div);
                }
                
                chapterDiv.appendChild(lessonsContainer);
                lessonsDiv.appendChild(chapterDiv);
            }
        }

        function isLessonUnlocked(lessonId) {
            const [chapter, lessonNum] = lessonId.split('-').map(Number);
            const [maxChapter, maxLesson] = game.maxUnlockedLesson.split('-').map(Number);
            
            if (chapter < maxChapter) return true;
            if (chapter === maxChapter && lessonNum <= maxLesson) return true;
            return false;
        }

        function runCode() {
            const code = document.getElementById('code-input').value;
            const lesson = lessons[game.currentLesson];
            const output = document.getElementById('output');
            
            if (!code.trim()) {
                output.innerHTML = '<span class="error">‚ùå Je hebt nog geen code geschreven! Typ eerst je spreuk.</span>';
                return;
            }
            
            const currentChallenge = lesson.challenges[game.currentAttack];
            
            if (currentChallenge.check(code)) {
                output.innerHTML = '<span class="success">‚úÖ Spreuk succesvol uitgevoerd!</span>\n\n';
                
                // Try to show actual output
                try {
                    const prints = code.match(/print\s*\(['"](.*?)['"]\)/g);
                    if (prints) {
                        prints.forEach(p => {
                            const match = p.match(/['"](.*?)['"]/);
                            if (match) {
                                output.innerHTML += 'üì§ Output: ' + match[1] + '\n';
                            }
                        });
                    }
                } catch(e) {}
                
                const damage = 30;
                game.enemy.hp -= damage;
                game.currentAttack++;
                
                output.innerHTML += `\n‚öîÔ∏è Je spreuk raakt! ${damage} schade aan ${game.enemy.name}!\n`;
                
                if (game.enemy.hp <= 0) {
                    output.innerHTML += `\nüéâ OVERWINNING! Je hebt ${game.enemy.name} verslagen!\n`;
                    output.innerHTML += `‚ú® +${lesson.xp} XP verdiend!\n`;
                    
                    gainXP(lesson.xp);
                    
                    if (!game.player.skills.includes(lesson.skill)) {
                        game.player.skills.push(lesson.skill);
                        output.innerHTML += `\nüéØ Nieuwe spreuk geleerd: ${lesson.skill}!\n`;
                        updateSkills();
                    }
                    
                    // Mark lesson as completed
                    if (!game.completedLessons.includes(game.currentLesson)) {
                        game.completedLessons.push(game.currentLesson);
                    }
                    
                    // Unlock next lesson
                    const nextLessonId = getNextLessonId(game.currentLesson);
                    if (nextLessonId && lessons[nextLessonId]) {
                        game.maxUnlockedLesson = nextLessonId;
                        const [nextChapter, nextLesson] = nextLessonId.split('-');
                        output.innerHTML += `\nüîì Les ${nextChapter}.${nextLesson} ontgrendeld!\n`;
                        
                        // Add button to go to next lesson
                        const nextBtn = document.createElement('button');
                        nextBtn.className = 'btn-next-lesson';
                        nextBtn.textContent = `‚û°Ô∏è Ga naar Les ${nextChapter}.${nextLesson}: ${lessons[nextLessonId].title.split(':')[1]}`;
                        nextBtn.onclick = () => loadLesson(nextLessonId);
                        document.getElementById('next-lesson-container').innerHTML = '';
                        document.getElementById('next-lesson-container').appendChild(nextBtn);
                        
                        renderLessons();
                    } else {
                        output.innerHTML += '\n\nüèÜ GEFELICITEERD! Je hebt alle lessen voltooid en bent nu een echte Meester Programmeur van Pythonia! üéä';
                    }
                } else {
                    // Next challenge
                    if (game.currentAttack < lesson.challenges.length) {
                        output.innerHTML += `\nüí™ Goed gedaan! Het monster is verzwakt maar nog niet verslagen!\n`;
                        output.innerHTML += `\nüéØ Nieuwe uitdaging geladen...\n`;
                        document.getElementById('challenge').innerHTML = lesson.challenges[game.currentAttack].text;
                        document.getElementById('code-input').value = '';
                    }
                }
            } else {
                output.innerHTML = '<span class="error">‚ùå Je spreuk werkt niet goed!</span>\n\n';
                output.innerHTML += 'üí≠ Controleer:\n';
                output.innerHTML += '‚Ä¢ Heb je de juiste spreuk gebruikt?\n';
                output.innerHTML += '‚Ä¢ Staan de haakjes en aanhalingstekens goed?\n';
                output.innerHTML += '‚Ä¢ Klik op "Vraag Hulp" voor een voorbeeld!';
            }
            
            updateUI();
        }

        function showHint() {
            const lesson = lessons[game.currentLesson];
            const currentChallenge = lesson.challenges[game.currentAttack];
            document.getElementById('output').innerHTML = `üí° Tip van Pythonicus:\n\n${currentChallenge.hint}\n\nüëÜ Probeer dit!`;
        }

        function gainXP(xp) {
            game.player.xp += xp;
            
            while (game.player.xp >= game.player.xpNext) {
                game.player.level++;
                game.player.xp -= game.player.xpNext;
                game.player.xpNext = Math.floor(game.player.xpNext * 1.5);
                game.player.maxHp += 20;
                game.player.hp = game.player.maxHp;
                
                const output = document.getElementById('output');
                output.innerHTML += `\n\nüéä LEVEL UP! Je bent nu level ${game.player.level}!\n`;
                output.innerHTML += `‚ù§Ô∏è Max HP verhoogd naar ${game.player.maxHp}!\n`;
            }
        }

        function updateSkills() {
            const skillsDiv = document.getElementById('skills');
            skillsDiv.innerHTML = '';
            
            if (game.player.skills.length === 0) {
                skillsDiv.innerHTML = '<p style="opacity:0.6;">Nog geen spreuken geleerd...</p>';
                return;
            }
            
            game.player.skills.forEach(skill => {
                const badge = document.createElement('span');
                badge.className = 'skill-badge';
                badge.textContent = skill;
                skillsDiv.appendChild(badge);
            });
        }

        function updateUI() {
            document.getElementById('level').textContent = game.player.level;
            document.getElementById('hp').textContent = `${game.player.hp}/${game.player.maxHp}`;
            document.getElementById('xp').textContent = `${game.player.xp}/${game.player.xpNext}`;
            document.getElementById('xp-bar').style.width = `${(game.player.xp / game.player.xpNext) * 100}%`;
            
            if (game.enemy) {
                document.getElementById('enemy-name').textContent = game.enemy.name;
                document.getElementById('enemy-hp').textContent = `${Math.max(0, game.enemy.hp)}/${game.enemy.maxHp}`;
                
                const lesson = lessons[game.currentLesson];
                document.getElementById('attack-count').textContent = `${game.currentAttack}/${lesson.challenges.length}`;
            }
        }

        // Initialize
        updateSkills();
    </script>
</body>
</html>